<app-navbar></app-navbar>
<div class="container">
  <h2>Cambiar Contraseña</h2>
  <form [formGroup]="changePasswordForm" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label for="oldPassword">Contraseña Actual</label>
      <input type="password" id="oldPassword" formControlName="oldPassword" class="form-control" required />
    </div>

    <div class="form-group">
      <label for="newPassword">Nueva Contraseña</label>
      <div class="input-group">
        <input 
          [type]="isPasswordVisible ? 'text' : 'password'" 
          id="newPassword" 
          formControlName="newPassword" 
          class="form-control" 
          required 
        />
      </div>
      <div *ngIf="changePasswordForm.get('newPassword')?.hasError('pattern')" class="text-danger">
        La nueva contraseña debe tener al menos 8 caracteres, una letra mayúscula, una letra minúscula, un número y un carácter especial.
      </div>
    </div>

    <div class="form-group">
      <label for="confirmPassword">Confirmar Nueva Contraseña</label>
      <div class="input-group">
        <input 
          [type]="isPasswordVisible ? 'text' : 'password'" 
          id="confirmPassword" 
          formControlName="confirmPassword" 
          class="form-control" 
          required 
        />
      </div>
      <div *ngIf="changePasswordForm.hasError('passwordsMismatch')" class="text-danger">
        Las contraseñas no coinciden.
      </div>
    </div>

    <!-- Botón para alternar visibilidad -->
    <div class="form-group">
      <button 
        type="button" 
        class="btn btn-outline-secondary" 
        (click)="togglePasswordVisibility()">
        <i [ngClass]="isPasswordVisible ? 'fa fa-eye' : 'fa fa-eye-slash'"></i> 
        Mostrar/Ocultar Contraseña
      </button>
    </div>

    <button type="submit" class="btn btn-primary" [disabled]="!changePasswordForm.valid">Cambiar Contraseña</button>
  </form>

  <div *ngIf="responseMessage" [ngClass]="{'alert-success': success, 'alert-danger': !success}" class="alert">
    {{ responseMessage }}
  </div>
</div>
